
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/pysap-astro/plot_galaxy_denoising.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_pysap-astro_plot_galaxy_denoising.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_pysap-astro_plot_galaxy_denoising.py:


Galaxy Image Denoising
======================

.. codeauthor:: Samuel Farrens <samuel.farrens@cea.fr>

In this tutorial we will remove the noise from an example galaxy image using
the PySAP-Astro plug-in.

Import dependencies
-------------------

Import functions from PySAP and
`ModOpt <https://cea-cosmic.github.io/ModOpt/>`_.

.. GENERATED FROM PYTHON SOURCE LINES 17-24

.. code-block:: default


    import numpy as np
    import matplotlib.pyplot as plt
    from pysap.data import get_sample_data
    from astro.denoising.denoise import denoise
    from modopt.signal.noise import add_noise








.. GENERATED FROM PYTHON SOURCE LINES 25-29

Clean image
-----------

First, we load the image of galaxy NGC2997 from the PySAP sample data sets.

.. GENERATED FROM PYTHON SOURCE LINES 29-32

.. code-block:: default


    galaxy = get_sample_data('astro-ngc2997')








.. GENERATED FROM PYTHON SOURCE LINES 33-34

Then we can show the clean galaxy image that we will attempt to recover.

.. GENERATED FROM PYTHON SOURCE LINES 34-38

.. code-block:: default


    plt.imshow(galaxy)
    plt.show()




.. image-sg:: /auto_examples/pysap-astro/images/sphx_glr_plot_galaxy_denoising_001.png
   :alt: plot galaxy denoising
   :srcset: /auto_examples/pysap-astro/images/sphx_glr_plot_galaxy_denoising_001.png, /auto_examples/pysap-astro/images/sphx_glr_plot_galaxy_denoising_001_2_0x.png 2.0x
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /volatile/Chaithya/actions-runner/_work/pysap/pysap/examples/pysap-astro/plot_galaxy_denoising.py:36: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
      plt.show()




.. GENERATED FROM PYTHON SOURCE LINES 39-45

Generate a noisy observation
----------------------------

To simulate an observation of NGC2997 we add random Gaussian noise with
standard deviation ``100`` using the
ModOpt :py:func:`add_noise <modopt.signal.noise.add_noise>` function.

.. GENERATED FROM PYTHON SOURCE LINES 45-48

.. code-block:: default


    obs_data = add_noise(galaxy.data, sigma=100)








.. GENERATED FROM PYTHON SOURCE LINES 49-50

Now we can show the noisy galaxy image.

.. GENERATED FROM PYTHON SOURCE LINES 50-54

.. code-block:: default


    plt.imshow(obs_data)
    plt.show()




.. image-sg:: /auto_examples/pysap-astro/images/sphx_glr_plot_galaxy_denoising_002.png
   :alt: plot galaxy denoising
   :srcset: /auto_examples/pysap-astro/images/sphx_glr_plot_galaxy_denoising_002.png, /auto_examples/pysap-astro/images/sphx_glr_plot_galaxy_denoising_002_2_0x.png 2.0x
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /volatile/Chaithya/actions-runner/_work/pysap/pysap/examples/pysap-astro/plot_galaxy_denoising.py:52: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
      plt.show()




.. GENERATED FROM PYTHON SOURCE LINES 55-59

.. note::

 :math:`\sigma=100` is quite excesive, but we can more easily visualise the
 noise added to the image in this example.

.. GENERATED FROM PYTHON SOURCE LINES 61-67

Denoise
-------

We will use the :py:func:`denoise <astro.denoising.denoise.denoise>` function
from PySAP-Astro to denoise the noisy image. We set the number of wavelet
scales to ``4``.

.. GENERATED FROM PYTHON SOURCE LINES 67-70

.. code-block:: default


    denoised_data = denoise(obs_data, n_scales=4)








.. GENERATED FROM PYTHON SOURCE LINES 71-72

We can show the denoised galaxy image.

.. GENERATED FROM PYTHON SOURCE LINES 72-76

.. code-block:: default


    plt.imshow(denoised_data)
    plt.show()




.. image-sg:: /auto_examples/pysap-astro/images/sphx_glr_plot_galaxy_denoising_003.png
   :alt: plot galaxy denoising
   :srcset: /auto_examples/pysap-astro/images/sphx_glr_plot_galaxy_denoising_003.png, /auto_examples/pysap-astro/images/sphx_glr_plot_galaxy_denoising_003_2_0x.png 2.0x
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /volatile/Chaithya/actions-runner/_work/pysap/pysap/examples/pysap-astro/plot_galaxy_denoising.py:74: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
      plt.show()




.. GENERATED FROM PYTHON SOURCE LINES 77-82

Residual
--------

Next, we calculate the residual of our denoised image to get a measure of
how well the denoising process performed.

.. GENERATED FROM PYTHON SOURCE LINES 82-85

.. code-block:: default


    residual = np.abs(galaxy.data - denoised_data)








.. GENERATED FROM PYTHON SOURCE LINES 86-87

Finally, we can show the residual.

.. GENERATED FROM PYTHON SOURCE LINES 87-91

.. code-block:: default


    plt.imshow(residual)
    plt.show()




.. image-sg:: /auto_examples/pysap-astro/images/sphx_glr_plot_galaxy_denoising_004.png
   :alt: plot galaxy denoising
   :srcset: /auto_examples/pysap-astro/images/sphx_glr_plot_galaxy_denoising_004.png, /auto_examples/pysap-astro/images/sphx_glr_plot_galaxy_denoising_004_2_0x.png 2.0x
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /volatile/Chaithya/actions-runner/_work/pysap/pysap/examples/pysap-astro/plot_galaxy_denoising.py:89: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
      plt.show()




.. GENERATED FROM PYTHON SOURCE LINES 92-96

.. tip::

 Typically for a denoising problem we are aiming for a residual without any
 structure, i.e. just noise.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  3.828 seconds)


.. _sphx_glr_download_auto_examples_pysap-astro_plot_galaxy_denoising.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_galaxy_denoising.py <plot_galaxy_denoising.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_galaxy_denoising.ipynb <plot_galaxy_denoising.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
